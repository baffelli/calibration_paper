\section{Methods and Data}\label{sec:methods}
\subsection{KAPRI: FMCW radar signal model}\label{sec:methods:signal_model}
A fundamental requirement to generate calibrated polarimetric data is the availability of properly processed SLC images for all elements of the polarimetric scattering matrix. To process them, it necessary to understand the data acquisition and correct several effects specific to KAPRI.  
For this purpose a signal model for type II\cite{Caduff2015} radar data using FMCW signaling\cite{Stove1992} is introduced.\\
\begin{figure}[h]
	\centering
	\includegraphics[scale=1]{real_aperture_signal_model_geometry}
	\caption{Geometric description of the displaced phase center with all relevant parameters. $R$ is the slant range from the radar to the point scatterer, $\theta_{3dB}$ is the antenna half power beamwidth, which is represented by the gray triangle. The size of the antenna aperture is $L_{wg}$, the corresponding azimuth resolution (in distance units) is $\delta_{az}$. The inset figure is used to derive the azimuth phase variation. $L_{ph}$ is the phase center displacement, $L_{arm}$ is the antenna rotation lever arm, $R_{0}$ the range of closest approach and $\alpha$ the additional rotation angle necessary to obtain closest approach when the phase center is not in the midpoint of the array but the rotation angle is measured assuming $L_{ph}=0$.}
	\label{fig:real_aperture_signal_model_geometry}
\end{figure}
Consider a coordinate system having its origin at the location of a radar, as depicted in \autoref{fig:real_aperture_signal_model_geometry}. In this system, the antenna is mounted on a lever arm of length $L_{arm}$; its mainlobe is parallel to the $x$ axis when the pointing angle $\theta$ is 0. The radar images a scene with a complex reflectivity distribution $\rho\left(x,y\right)$ by measuring range profiles $\hat{\rho}\left(R, \theta\right)$ for a number of antenna azimuths angles $\theta = \operatorname{arctan}\left(\frac{y}{x}\right)$ by rotating the antenna assembly with angular speed $\omega$. Each profile is measured by transmitting a linearly modulated signal of duration $t_{chirp}$ with bandwidth $B$ and center frequency $f_c$:
\begin{equation}
	s_t\left(t\right) = e^{j 2 \pi \left( t f_{c} +  \frac{B}{t_{chirp}} t^2 \right)}.
\end{equation}
The total time that the signal needs to travel to a scatterer at range $R$ and back is $t_{c} = \frac{2 R}{c}$. The backscattered signal $s_r$ is a copy of the one being transmitted; delayed by $t_{c}$ and scaled by the complex reflectivity of the scatterer $\rho$.
\begin{equation}
		s_r\left(t\right) = \rho e^{j 2 \pi \left( \left(t - \frac{2 R}{c}\right) f_{c} +  \frac{B}{t_{chirp}} \left(t - \frac{2 R}{c}\right)^2 \right)}.
\end{equation}
In the radar, $s_r$ is mixed with the transmitted chirp $s_t$  to remove the linear modulation, resulting in a deramped signal $s_d$ which is sampled and stored: 
\begin{equation}\label{eq:deramp}
	\begin{aligned}
	s_{d}\left(t\right) &=s_t\left(t\right)s_r\left(t\right)^* =\\ 
	&\sigma e^{j 4 \pi \frac{ R}{c}f_c}  e^{j 4 \pi \frac{2 R B }{c t_{chirp}} t}  e^{j 4 \pi \frac{2 R^2 B}{c^2}}.
	\end{aligned}
\end{equation} 
The dechirped signal is a complex sinusoidal whose frequency $f_{b} = \frac{4 R B}{c t_{chirp}}$ is proportional to the slant range $R$;
two phase terms can be identified: $ e^{j 4 \pi \frac{R}{c}f_c}$ is the two way propagation phase, the quantity of interest for  interferometric measurements. The second component, proportional to the squared distance, is named "range video phase" in SAR processing, where its variation over the aperture length may causes defocussing. Although KAPRI is a real-aperture system, a SAR-like azimuth processing step is required to correct a residual azimuth phase ramp, as described in \autoref{sec:methods:azimuth_processing}. However, in this case the variation of $R$ during the aperture length is minimal and the range video term can be ignored.\\
From \autoref{eq:deramp} an by the linearity of the Fourier transform, it follows that the range profile $\hat{\rho}\left(R, \theta\right)$ of a collection of scatterers with complex reflectivity $\rho_i$ at ranges $R_{i}$ can be estimated by the Fourier transform of $s_{d}\left(t\right)$.\\
As in pulsed radars, the range resolution using FMCW signals is inversely proportional to the bandwidth:
\begin{equation}\label{eq:range_resolution_theoretical}
	\delta_{r} = \frac{c}{2 B}.
\end{equation}
Using a bandwidth of 200 MHz, the theoretical range resolution for KAPRI is 0.75 m\cite{Strozzi2011}; the effective range resolution is observed to be lower because a Kaiser window is applied to the data before the Fourier transform to mitigate range sidelobes.\\
To obtain two dimensional images, range profiles are acquired while the antenna is rotated with angular velocity $\omega$. 
In this case, the deramped signal for a point target at $R,\theta_t$ is:
\begin{equation}\label{eq:signal_model}
	\begin{aligned}
	& s_{d}\left(t,\tau\right) = \rho e^{j 4 \pi \frac{ R}{c}f_c}   \\
	& e^{j 4 \pi \frac{2 R B }{c t_{chirp}} t}  e^{j 4 \pi \frac{2 R^2 B}{c^2}} P\left(\tau \omega - \theta_t\right),
	\end{aligned}
\end{equation} 
where $t$ is the fast time, corresponding, $\tau = n t_{chirp}$ is the slow time and $P\left(\tau \omega\right)$ describes the two way antenna pattern with beamwidth:
\begin{equation}\label{eq:azimuth_resolution}
	\theta_{3dB} = \frac{\lambda}{L_{wg}},
\end{equation}
where $L_{wg}$ is the size of the antenna aperture and $\lambda$ is the wavelength employed.
If the rotation speed is chosen such that $\omega \tau \ll \theta_{3dB}$, the acquisition is oversampled in azimuth and several range profiles represent the same target. Their average in slow time  -called azimuth presum or azimuth decimation- produces measurements with an increased signal to noise ratio, assuming they all are affected by the same uncorrelated noise process.
Due to diffraction, the radiation beam emitted by the antenna broadens linearly with increasing distance consequently, the spatial resolution in cross-range $\delta_{az}$ increases with distance:
\begin{equation}\label{eq:azimuth_ground_resolution}
	\delta_{az} = \frac{R \lambda}{L_{wg}},
\end{equation}
\subsection{Beam Squint Correction}\label{sec:methods:squint_correction}
\begin{figure*}[Ht!]
	\centering
	\begin{subfigure}[b]{\columnwidth}
	\includegraphics[scale=0.5]{antenna_squint}
	\caption{}
	\label{fig:antenna_squint}
	\end{subfigure}~
	\begin{subfigure}[b]{\columnwidth}
	\includegraphics[scale=0.5]{squint_correction_interpolation}
	\caption{}
	\label{fig:antenna_squint_correction_interpolation}
	\end{subfigure}
	\caption{(a) Illustration of the frequency-dependent pointing direction $\theta_{sq}$ of the main lobe of the slotted waveguide antennas of KAPRI. The response at different chirp frequencies is represented by the colors of the mainlobes; they correspond to the increasing chirp frequencies as they are represented by the inset plot. The corresponding waveguide wavelengths are displayed underneath the antenna. For the design wavelength $\lambda_{g}^{design}$, the antenna mainlobe points at the antenna broadside.\\
	(b) The plots represent the time domain envelope of a point target as a function of chirp time $t$ (y-axis) and slow time $\tau = n t_{chirp}$ (x-axis). The y-axis is proportional to the transmitted frequency, the x-axis to the rotation angle of the antenna. If the antennas mainlobe would not change its direction during the chirp, a beat signal as shown in the bottom would be obtained. It would have a frequency proportional to the range and would cover the slow time extent where the objects stays within the beamwidth. In the case when the mainlobe changes direction with frequency, the response is skewed because the target is only illuminated at the moment when the mechanical and the electrical antenna pointing direction match, causing its response to occupy several azimuth cells. After range compression, obtained with a Fourier transform along the $t$ axis, the frequency-dependent antenna pointing would cause a loss of range resolution because only a fraction of the transmitted bandwidth would be used for each azimuth bin. To correct this effect, the data is interpolated in the time domain in order to reconstruct the full bandwidth by combining the subsequent sub-bandwidths that are obtained at different mechanical pointing angle. This correction requires sufficient azimuth oversampling, which is achieved by slow rotation of the antennas w.r.t the chirp duration.}
	\label{fig:squint_correction}
\end{figure*}
Thus, to obtain the desired cross-range resolution at the distances of interest, a sufficiently narrow antenna beamwidth is required. To do so, KAPRI employs a 2 meter long traveling wave slotted waveguide antenna\cite{Hines1953a,Granet2007}. It is constructed by cutting slots resonating at the design frequency in a section of rectangular waveguide. When the slots are appropriately spaced, the fields emitted by the cuts combine in phase, producing a narrow beam in the desired direction.\\ Two types of slotted waveguide antenna exist\cite{Enjiu2013}: the resonant and the traveling wave design. The second type has been chosen because it can be operated with a larger bandwidth; achieving a finer range resolution. The main drawback of this antenna design is its frequency-dependent beam squint: when it is operated at frequency differing from the design value, the phase differences at the slots change; altering the direction of the mainlobe. If a chirped signal is transmitted, the mainlobe direction continuously changes during the pulse. This effect has been uses for several fast imaging radar, where a mechanical antenna rotation would not be possible\cite{Yang2014,Yang2012,Mayer2003,Alvarez2013}. In the case of KAPRI the beam squint is undesired: because of the large angular deviation relative to the beamwidth, the mainlobe is only centered on a scatterer during a fraction of $t_{chirp}$, decreasing the effective transmitted bandwidth and hence the range resolution. \\ 
In oversampled data, the effect of beam squint is visible as skewed point target responses, as illustrated in~\autoref{fig:squint_correction}: during the chirp, the target is only at the center of the beamwidth when the antenna rotation angle matches the beam squint angle. 
The availability of raw data oversampled in azimuth is key to mitigate the effect of the beam squint:\\ For each chirp frequency $f$, the data at the corresponding fast time $t_{f} = t_{chirp}\frac{f - f_c}{B}$  is shifted in slow time by $\tau_{sq}=\frac{\theta_{sq}}{\omega}$, where $\theta_{sq}$ is the squint angle:
\begin{equation}\label{eq:squint_exact}
	\theta_{sq} = \sin^{-1}\left(\frac{\lambda}{\lambda_{g_{ij}}} + \frac{k \lambda}{s}\right),
\end{equation}
here ${\lambda_g}_{ij}$ is the wavelength for the $ij$-TE mode of the waveguide, $\lambda$ is the freespace wavelength, $s$ is the element spacing and $k$ is the mode number. In this case, the waveguide mode used is $TE_{01}$ and $k=0$ is assumed because all the slots are to be transmitting in phase\cite{kraus88} to direct the main beam at the antenna broadside.\\
Instead of using the above expresison, a linear approximation for the squint relative to the pointing direction at the design frequency $f_c$ is used to process KAPRI data:
\begin{equation}\label{eq:squint_linearised}
	\theta_{sq} - \theta_{sq}^{f_{c}}  =  a f.
\end{equation}
This is necessary because manufacturer-provided antenna pattern measurements at different frequencies suggest that the vertically and the horizontally polarized units have different squint characteristics. Because the design information necessary to use the above exact expression for the squint is not available, a data-driven method has to be used for the correction of the beam squint.\\ To estimate the linearized squint rate $a$, the response of a strong point-like target is extracted from the data by windowing it in range and converting it back in the fast time domain with a Fourier transform; its envelope is then extracted with a discrete Hilbert transform. The peak location at each frequency is localized, a fit using \autoref{eq:squint_linearised} is performed to obtain an estimate of $a$.\\
To correct the frequency-dependent beam squint the azimuth sample spacing must be smaller than the antenna beamwidth: this permits to reconstruct the full bandwidth illumination of each scatterer with by combining chirp samples acquired at subsequent azimuth positions.

After correcting the beam squint, azimuth presumming can be applied if desired to reduce the data size and increase SNR. Then, an Hann window is applied to the first and last $z$ samples of the raw data $s_{d}$ to mitigate the transient signal caused by the abrupt change in frequency due to the repetition of the chirp and the end of each pulse. A Kaiser Window is then applied to reduce range processing sidelobes that are caused by the finite bandwidth. Finally, a fast time Fourier transform performs the range compression to obtain the SLC image $\hat{\rho}\left(R, \theta\right)$.
\\ Each range line of the SLC thus compressed is then multiplied by $\sqrt{R^3}$ to compensate for the power spreading loss. In this manner, the intensity of the SLC data is directly proportional to the radar brightness $\beta_{0}$\cite{Raney1994}. 
\subsection{Azimuth Processing}\label{sec:methods:azimuth_processing}
In the case of KAPRI, the correction of frequency-dependent squint as described in the preceding section is not sufficient to produce correct SLC data: a strong residual  azimuth phase is observed on the response of point-like scatterer, especially in the VV channel. This phase contribution represents a problem for two reasons:
\begin{enumerate}
	\item Because the azimuth samples have differing phases
	, it will lead to a reduced amplitude and worse SNR after azimuth presumming. 
  \item Since each polarization displays a different ramp, the coherence magnitude of polarimetric phase differences will be reduced and the resulting coherence phase will be affected by a residual phase variation. For example, if the HH-VV phase is needed for calibration in the method described in \autoref{sec:methods:proc_polcal} and the azimuth variation is not taken into account, the additional phase will lead to the incorrect calibration parameters.\label{item:phase_variation}
\end{enumerate}
The azimuthal phase variation is suspected to be due to the rotational geometry of acquisition: as the antennas are mounted with an  offset $L_{arm}$(see \autoref{fig:real_aperture_signal_model_geometry}) from their center of rotation, the distance from the phase center to a scatterer varies with the azimuth position, which in turn results in a change in propagation phase~\cite{Lee2014}. If the variation in distance is sufficiently large compared to the range resolution, the target will move through several range cells during the acquisition, an effect named \emph{range cell migration} in SAR processing, where it needs to be compensated before using the phase variation to synthesize the aperture. Fortunately, in the case of KAPRI the variation in distance approximatively two orders of magnitude smaller than the range resolution and will only visibly affect the phase of the signal, with no appreciable range cell migration.\\
To model this the phase ramp, consider the radar acquisition geometry depicted in \autoref{fig:real_aperture_signal_model_geometry}:\\
The antennas are mounted on a lever arm of length $L_{arm}$ that connects them to the azimuth scanner.
The phase center of the antenna is allowed to be horizontally displaced from the lever arm attachment by $L_{ph}$.
A point target is considered, located at the  range of closest approach $R_{0}$, obtained when the phase center, the target and the lever arm are aligned. Thus, $\phi_{scan}$, the phase variation relative to the phase at closest approach for a rotation  $\theta_r$  is given by:
\begin{equation}\label{eq:range_phase}
	\phi_{scan} = \frac{4 \pi}{\lambda}\left(R\left(\theta_r\right) - R_0\right),
\end{equation}
here $R$ is the effective distance between the point target and the phase center.
It is computed using the law of cosines on the green triangle of \autoref{fig:real_aperture_signal_model_geometry} with the included angle $\theta_r$, one  side $L_{ant} = \sqrt{L_{arm}^2 + L_{ph}^2}$ and the other $c = L_{ant} + R_0$.
\begin{equation}\label{eq:range}
	R = \sqrt{ c^2 +  L_{ant}^2 - 2 c L_{ant} \cos{\left(\theta_r - \alpha\right)}}.
\end{equation}
$L_{ant}$ is interpreted as the equivalent lever arm of an antenna without the horizontal phase center shift that would produce the same phase variation as a system with a nonzero $L_{ph}$ and a shorter lever arm.
The function is shifted by the angle  $\alpha = \operatorname{\arctan}\left({\frac{L_{ph}}{L_{arm}}}\right)$ that describes the additional rotation needed for an antenna with nonzero $L_{ph}$ to be at closest approach. This shift is necessary because the azimuth angle is measured assuming a zero $L_{ph}$: the reading given by the angle encoder does not correspond to the angular position of the phase center.\\
The complete characterization of the phase ramp requires the knowledge of the antenna phase center displacement $L_{ph}$. Normally, it is assumed that the phase center is at the midpoint of the antenna. However, when the experimental data was analyzed using this assumption (which implies $L_{ant} = L_{arm}$),  \autoref{eq:range} failed to model the observed azimuth phase variation. The model was thus extended to account for the possibility of a displaced antenna phase center, which is presumed to describe physical differences in the antennas, which would explain the presence of the azimuth phase in the VV channel only.\\ $L_{ph}$ is estimated using the measured phase of a point target by minimizing the squared distance between it an the phase simulated according to \autoref{eq:range}.
\begin{equation}\label{eq:rph_estimation}
	\hat{L_{ph}} = \underset{\left(L_{ph}, \phi_{off}\right)}{\operatorname{argmax}}{\vert\vert\phi_{meas} - \phi_{scan}\vert\vert}^2,
\end{equation}
where $\phi_{sim} = \phi_{scan} + \phi_{off}$ is the simulated phase with an additional offset that accounts for noise and the intrinsic scattering phase and the system.\\
As seen in \autoref{eq:range}, the distance of each scatterer is a function of the relative rotation angle $\theta_r$ of the antenna. Thus azimuth and distance are coupled, an effect know as Range Cell Migration . In this case, the range resolution is significantly smaller than the amount of RCM and only affects the phase (\autoref{eq:range_phase}).\\
When $L_{ph}$ is known, the azimuth phase variation is corrected in each range line $R_{i}$ using \autoref{eq:range} as a matched filter:
\begin{equation}\label{eq:correction}
	\begin{aligned}
		s_{d}^{corr}\left(\theta, R_{i}\right) = &\int\limits_{-\frac{\theta_{int}}{2}}^{\frac{\theta_{int}}{2}}e^{\jmath \frac{4\pi}{\lambda}R\left(\theta - \theta^{\prime}, R_{i}\right)}\\
		&s_{d}\left(\theta^\prime\right) d\theta^\prime.
	\end{aligned}
\end{equation}
The formula replaces the azimuth averaging described in \autoref{sec:methods:signal_model}: the samples are now averaged with the appropriate phase factor so that the SNR improvement and the correction of the azimuth trend are combined in a single step. Usually, after convolution only the central pixel of the integration window is kept, to reduce the amount of data, as the original acquisition is always oversampled in azimuth. Because the model only describes the variation of the phase relative to closest approach $R_{0}$, the absolute phase is preserved; this is very important for interferometric applications.\\
The procedure is similar to azimuth focusing of synthetic aperture data, where the cross-range resolution is obtained by the integration of the data in the azimuth-time direction. However, in the case of real aperture systems the resolution is limited by physical antenna beamwidth and the response of a target  occupies a single azimuth sample; unless the data is oversampled. In the first case, integrating the data in azimuth degrades the resolution because samples that do represent the same scatterer are combined.\\ To correct the phase variation without an excessive increase in azimuth resolution, the integration is limited to a window of size $\theta_{int}$. The optimal trade-off is empirically determined to be 0.6$^\circ$, slightly larger than $\theta_{3dB}$.
\subsection{Antenna Pattern Misalingment}\label{sec:methods:misalingment}
In addition to the difference in frequency-dependent squint rate and of differing phase center locations, the horizontally and vertically polarized antenna display an azimuth pattern mispointing of $0.2^\circ$. It was first observed by analyzing the response of strong point-like target, where a significant misregistration between the HH and the VV images was observed. The misalignment is particularly problematic for cross-polar measurements: the transmitting and receiving patterns are not aligned. Using the available pattern information a power loss of approx 2.5 dB  compared to the ideal case is predicted. This loss reduces the SNR for the cross-polar channels, leading to noisier measurements.\\ While the offset between copolar channels can be corrected by coregistration without major consequences, there is no method capable to compensate the SNR loss in the crosspolar measurements a posteriori. An adjustable antenna mount was manufactured by replacing one of two hinges where the antennas are fixed on the towers (see \autoref{fig:adjustable_bracket}) with an adjustable bracket that allows to slide the antenna back and forth on the one side, obtaining the effect of rotating it around the center. Basing on the size of the antenna mounting bracket and on the amount of misaligment, it was determined that the horizontally polarized antennas need to be shifted by 1.8 mm to compensate it fully.
\begin{figure}[ht]
	\centering
	\includegraphics[scale=0.4]{antenna_offset_2}
	\caption{Illustration of the adjustable antenna mount allowing to shift the patterns to bring the H and the V antennas into alignment. The left bracket can be slid towards the front, allowing the antenna to pivot on the right hinge. For small shifts, this movement approximates a rotation around the center of the antenna tower, as depicted by the blue antenna pattern.}
	\label{fig:adjustable_bracket}
\end{figure}
\subsection{Removal of Topographic Phase}\label{sec:methods:topo_removal}
\begin{figure}[ht]
	\centering
	\includegraphics[scale=0.5]{kapri_antenna_arrangement}
	\caption{KAPRI radar during a field test. The antenna arrangement used in this paper is overlaid. The blue and red dots represent the equivalent phase centers for the  HH and VV channels from the upper receiver. The lower blue dot the one for the lower HH channel, which is used in conjunction with the upper HH phase center to estimate the topographic phase contribution.}
	\label{fig:antenna_arrangement}
\end{figure}
 The next step on the way to calibrated polarimetric data requires a brief review of KAPRIs antenna configuration, depicted in \autoref{fig:antenna_arrangement}:\\ Six antennas are mounted on a supporting structure connected to the rotary scanner. Of these, 2 are transmitting antennas, one for each polarization. The remaining 4 are connected in pairs through switches to the receivers; each pair composed of an horizontally and a vertically polarized unit. This configuration permits to acquire full polarimetric dataset by selecting the desired antennas for the transmitter and for each receiver separately. This arrangement ensures a low level of polarimetric crosstalk because only one combination is acquired at each time and the antennas are physically separated. Additionally, the separation of transmitting and receiving antennas increases the transmit-receive isolation, a fundamental requirement for FMCW performance\cite{Beasley1990,Stove1992, Strozzi2011}.  However, this configuration complicates the phase calibration of polarimetric data by introducing additional phase terms unrelated to scattering properties.\\
To understand why, consider an image acquired by transmitting at antenna located at $\mathbf{x_t^i}$ and receiving at $\mathbf{x_r^i}$. These antennas can be replaced by an equivalent antenna located at $\mathbf{x_{eq}^i}$, the midpoint between transmitter and receiver \cite{Pipia2009}. Thus, for polarimetric observations using  KAPRI the equivalent antenna phase center $\mathbf{x_{eq}^i}$ location will change depending on the chosen polarization. Therefore, there exist certain combinations of channels $i$ and $j$ where the equivalent phase centers are separated by a baseline $\mathbf{b_{ij}^{eq}}$. Consequently, the polarimetric phase difference   will contain an interferometric contribution:
\begin{equation}
	\phi_{ij} = \phi_{ij}^{pol} + \phi_{ij}^{prop}
\end{equation}
This term appears as topographic fringes when visualizing the polarimetric phase difference and will complicate calibration by adding an additional phase contribution unrelated to the polarimetric properties of the scatterers.\\
To obtain correct polarimetric phase differences, it is necessary to estimate and subtract the interferometric contribution. This can be done  by considering two additional channel $k$ and $l$  acquired with  a non-zero baseline $\mathbf{b_{ij}^{eq}}$ and with the same polarization, where $\phi_{kl}^{pol} \approx 0$. Generally, for any two channels $m$ and $n$,  the propagation phase difference can be approximated as a function of the local incidence angle and of the perpendicular baseline separating the phase centers:
\begin{equation}\label{eq:prop_approximation}
		\phi_{mn}^{prop} = \frac{4\pi}{\lambda} b_{mn}^{eq} \sin(\theta - \alpha_{bl}),
\end{equation}
where $\alpha_{bl}$ is the baseline angle w.r.t to the vertical and the look angle $\theta_l$ is the angle between the line of sight vector $\mathbf{p}$ and the vertical axis and $b_{ij}^{eq}$ is the perpendicular baseline between the equivalent phase centers.
Thus from \autoref{eq:prop_approximation}, $\phi_{ij}^{prop}$ can be estimated from $\phi_{kl}$ if the look angle does not significantly change from $kl$ to $ij$, i.e if $\theta_{ij} - \alpha_{ij} \approx \theta_{kl} - \alpha_{kl}$. 
\begin{equation}
	\hat{\phi}_{ij}^{prop} = \frac{b_{eq}^{ij}}{b_{eq}^{kl}} \phi_{kl}.
\end{equation}
This formula is only valid if $\frac{b_{eq}^{ij}}{b_{eq}^{kl}}$ is integer\cite{Massonnet1996}, otherwise phase unwrapping of $\phi_{kl}^{prop}$ is necessary before rescaling.\\
In order to correct for all the possible combinations that have a non-zero baseline, the measured scattering matrix $\mathbf{S}$ is converted into a polarimetric covariance matrix $\mathbf{C}$;  $\hat{\phi}_{ij}^{prop}$ it then subtracted from the phase of every non-diagonal element $ij$. The result is a flattened covariance matrix $\mathbf{C_{flat}}$ where the sole phase contribution is the polarimetric phase difference, possibly affected by an offset that needs compensation in the polarimetric calibration.\\
\subsection{Polarimetric Calibration}\label{sec:methods:proc_polcal}
This matrix is the starting point for the polarimetric calibration proper;
the procedure is based on a linear distortion matrix model\cite{Saraband1990, Sarabandi1992a} that relates the observed scattering matrix $\mathbf{S^\prime}$ with the theoretical one $\mathbf{S}$:
\begin{equation}\label{eq:distorsion_scattering}
	\mathbf{S^\prime} = \mathbf{R} \mathbf{S} \mathbf{T}.
\end{equation}
The same can be restated for polarimetric covariance matrices $\mathbf{C} = \mathbf{S}^{H}\mathbf{S}$:
\begin{equation}\label{eq:covariance_distortion}
	\mathbf{C}^\prime = \mathbf{D} \mathbf{C} \mathbf{D}^{H}.
\end{equation}
where $\mathbf{D}$ is the Kronecker product of $\mathbf{R}$ and $\mathbf{T}$, the matrices that describe the phase and amplitude imbalances and crosstalk in reception and transmission.
In the case of KAPRI, crosstalk calibration is not performed as the radar is known to have a good polarization isolation, largely due to the fact that only one polarization is acquired at a time by selecting the appropriate combination of transmitting and receiving antennas. Therefore, the only source of crosstalk is the presence of cross-polarized lobes in the direction of the antenna mainlobe. The manufacturer has provided simulated radiation patterns for the horizontally polarized antennas, where the isolation between the co and the cross polarized pattern in the main-lobe direction is observed to be better than 60 dB. Additionally, by computing the VV-HV ratio of the oversampled response of a trihedral corner reflector, the polarization purity of the system was estimated to be better than 35 dB.\\
In this case, the distortion matrices simplify to:
\begin{equation}
	\begin{aligned}
	&\mathbf{R} = A \begin{bmatrix}
		1 & 0\\
		0 & f/g e^{i\phi_{r}}
	\end{bmatrix},\\
	&\mathbf{T} = A \begin{bmatrix}
			1 & 0\\
			0 & f g e^{i\phi_{t}}
		\end{bmatrix},
	\end{aligned}
\end{equation}
where $f$ is the one-way copolar amplitude imbalance with respect to the H polarization, and $g$ the amplitude imbalance of the crosspolarized channels. $\phi_t = \phi_{t,h} -\phi_{t,v}$ is the phase offset between the polarizations when transmitting and $\phi_{r} = \phi_{r,h} -\phi_{r,v}$ is the phase offset in reception and $A$ is the absolute amplitude calibration parameter (RCS)\cite{Ainsworth2006a, Fore2015}.\\
The four unknown complex parameters in $\mathbf{D}$ can be determined using a trihedral corner reflector and a reciprocal scatterer with a significant cross polarized contribution\cite{Sarabandi1989,Pipia2009}.\\
Thus, observing an ideal trihedral reflector with RCS $\sigma_{tri}$, would give 
a measured covariance matrix $\mathbf{C^{\prime}}$:
\begin{equation}
	\begin{aligned}
	&\mathbf{C^{\prime}} =\\
	&= A^2 \sigma_{tri}\\
	&\begin{bmatrix}
		1 & 0 & 0 & f^2 e^{-i \left(\phi_t + \phi_r\right)}\\
		0 & 0 & 0 & 0\\
		0 & 0 & 0 & 0\\
		f^2 e^{i \left(\phi_t + \phi_r\right)} & 0 & 0 & f^4
	\end{bmatrix}.
	\end{aligned}
\end{equation}
Therefore, the  copolar amplitude imbalance $f$ can be estimated by the ratio of $C_{HHHH}^\prime$ and $C_{VVVV}^\prime$:
\begin{equation}
	f = \left(\frac{C^{\prime}_{VVVV}}{C^{\prime}_{HHHH}}\right)^{\frac{1}{4}}.
\end{equation}
The copolar phase imbalance $\phi_r + \phi_t$ is estimated from the phase of $C_{VVHH}^{\prime}$:
\begin{equation}
	\phi_r + \phi_t = \operatorname{arg}\left(C_{VVHH}^\prime\right).
\end{equation}
Both parameters are estimated on the oversampled response of a corner reflector. In \cite{Fore2015}, a polynomial model for the copolar calibration parameters is used, that links the imbalances to the incidence angle. In that case, the estimate are performed using a larger array of corner reflectors, which is not available in our case. Thus, a simplified calibration model is used, assuming the copolar parameters to be independent of incidence angle.\\ 
Because of the difficulty of placing and correctly orienting a cross polarizing target such as a $45^\circ$ dihedral, the estimation of $g$ and $\phi_t - \phi_r$ is based on the assumption that most pixels in the data represent reciprocal scatterers:
\begin{equation}
	g = \left<\frac{C_{HVHV}^{prime}}{C_{VHVH}^{\prime}}\right>^\frac{1}{4}
\end{equation}
and:
\begin{equation}
	\phi_t - \phi_r =\operatorname{arg}\left( \left<C_{HVVH}^{\prime}\right>\right).
\end{equation}
Once $\mathbf{D}$ is estimated, \autoref{eq:covariance_distortion} is inverted to obtain a calibrated covariance matrix.\\
If radiometric calibration is desired, the value of $A$ can be determined after imbalance correction from the ratio of the expected and the measured RCS.
\begin{equation}
	A =	\left(\frac{\sigma_{tri}}{C^{\prime}_{HHHH} R_{tri}^{3}}\right)^\frac{1}{2}.
\end{equation}
Where $R_{tri}$ is the slant range to the trihedral corner reflector. This is necessary to remove the range spread loss compensation as performed in \autoref{sec:methods}.
\subsection{Experimental Data}\label{sec:methods:data}
A calibration dataset was acquired in September 2016 at an urban-agricultural area near M\"{u}nsingen, Switzerland to test the methods described in the preceding sections. The data was acquired from the top of the "Chutzen" hill approximately 800 m a.s.l, looking down towards a mixture of fields and forests, with the town in the far range region. 6 Trihedral Corner Reflectors were placed in the area for the determination of calibration parameters and to assess imaging quality. Three of these reflectors have triangular faces with a length of 40 cm, corresponding to a RCS of $\sigma=\frac{4}{3}\pi \frac{a^4}{\lambda^2}=25.5 dB$, while the remaining two are cubic corner reflector with $\sigma= 35 dB$, at the nominal central frequency of 17.2 GHz.
	\begin{figure*}
		\centering
		\includegraphics{figure_7}
		\caption{Pauli RGB composite ($R=\abs{HH-VV},G=\abs{HV},B=\abs{HH+VV}$) of the imaged scene, geocoded using a DEM with 2m pixel spacing. Each channel is scaled according to its dynamics. The location of corner reflectors is marked by cyan circles, the reflector used the determination of polarimetric calibration parameters in orange. The image is overlaid on a 1:25000 scale Swiss topographic map (Reproduced with the authorisation of swisstopo  JD100042).}
		\label{fig:pauli_rgb}
	\end{figure*}
\autoref{fig:pauli_rgb} shows the calibrated Pauli RGB composite of the scene, resampled in Cartesian coordinates with the location of the reflectors marked using blue circles; their location and RCS is summarized in \autoref{tab:reflectors}.\\
The dataset was acquired with the horizontally polarized antenna group shifted towards the V group by 1.8 mm to compensate for the pattern misalignment as described in \autoref{sec:methods:misalingment}.\\
A separate dataset containing a dihedral reflector was acquired at our H\"{o}nggerberg campus in order to investigate the effect of antenna pattern misalignment on crosspolar acquisitions and to test the suitability of the computed adjustment value as discussed in \autoref{sec:methods:misalingment}. This measurement was held separately because of the logistical problems associated with the transportation and the setup of large dihedral calibration targets.

\begin{table}[ht]
	\centering
	\pgfplotstabletypesetfile[
								every head row/.style={before row=\toprule,after row=\midrule},
								every last row/.style={after row=\bottomrule},
								col sep=comma,
								columns={name, rsl, RCS, type},
								columns/name/.style={column name={Name} ,string type},
								columns/type/.style={column name={Type} ,string type},
								columns/RCS/.style={precision=1, column name=$\sigma_0$},
								columns/rsl/.style={precision=1, column name=$R_0$}
										] {../tab/table_1.csv}
	\caption{Summary of TCRs in the calibration dataset: Name of nearest map feature, Distance from the radar, expected radar cross section, type of reflector.}
	\label{tab:reflectors}
\end{table}



