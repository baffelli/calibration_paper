\section{Results}\label{sec:results}
\subsection{FMCW Data Processing}\label{sec:res_SLC}
In order to assess the processing quality and to appreciate the effect of the beam squint correction,  the oversampled impulse response of the TCR at 673 m range is plotted in \autoref{fig:tcr_mph}. No azimuth averaging was applied to this data, to better visualize the effects described above. The plots on the left side (a), and (d) contain the response obtained by range compression of the acquired data without any transformation. The phase displays a cross-like pattern, centered on the maximum, presumably the effect of the frequency-dependent beam squint during the scan.\\ A visual comparison with the responses obtained enabling the squint compensation shows an improvement in range resolution, which is verified numerically by fitting a spline on the range response at the maximum and computing its $3 dB$ width. The azimuth resolution is also estimated in a similar manner.\\ The numerical results are displayed in each plot of \autoref{fig:tcr_mph}; significant improvements in range resolution are noticed after correcting for the frequency-dependent squint. However, a residual azimuthal phase is observed in the VV channel. This ramp is not unique to the particular reflector being analyzed: A linear variation of 30 degrees over the 3dB antenna beamwidth can be observed for all reflectors in the same data, as plotted in \autoref{fig:phase_response_VV:uncorrected}.
\begin{figure*}[ht]
	\centering
	\includegraphics{figure_1}
	\caption{Oversampled phase and amplitude responses for the corner reflector "Hindere Chlapf" at 673 m slant range. (a) HH channel without correction, (b) HH channel with frequency-dependent squint compensation (c) same as (b) with azimuth phase ramp removal. (d) VV channel without correction, (e) VV channel with frequency-dependent squint compensation (f) same as (e) with azimuth phase ramp removal.
	The phase of each response is referenced to its maximum.}
	\label{fig:tcr_mph}
\end{figure*}

\subsection{Azimuth Processing}\label{sec:azimuth_processing}
The residual  azimuth phase observed in the VV channel in \autoref{sec:res_SLC} represents a problem for two main reasons: \begin{enumerate*}
	\item Because the azimuth samples have differing phases
	, it will lead to a reduced amplitude and worse SNR after azimuth presumming. 
  \item as each polarization displays a different ramp, the coherence magnitude of polarimetric phase differences will be reduced and the resulting coherence phase will be affected by a residual phase variation. For example, if the HH-VV phase is needed for calibration in the method described in \autoref{sec:proc_polcal} and the azimuth variation is not taken into account, the additional phase will lead to incorrect calibration parameters.\label{item:phase_variation}\end{enumerate*}\\
The azimuthal phase variation is attributed to the rotational geometry of acquisition: as the antennas are mounted with an  offset $L_{arm}$ from their center of rotation~\cite{Lee2014}, the distance from the phase center to a scatterer varies with the azimuth position. Thus, the phase center is describing a circular sector of radius $L_{arm}$. This is analogy to SAR systems, where the phase variation induced by the phase center motion is exploited to synthesize a large aperture. However,  in case of KAPRI the beamwidth is too small to synthesize a substantial aperture; the only effect of the motion is an undesired azimuth phase.\\
To model the phase ramp, consider again the radar acquisition geometry of \autoref{fig:real_aperture_signal_model_geometry}:
The antennas are mounted on a lever arm of length $L_{arm}$ that connects them to the azimuth scanner.
The phase center of the antenna is allowed to be horizontally displaced from the lever arm attachment by $L_{ph}$.
A point target is considered, located at the  range of closest approach $R_{0}$, obtained when the phase center, the target and the lever arm are aligned. Thus, $\phi_{scan}$, the phase variation relative to the phase at closest approach for a rotation  $\theta_r$  is given by:
\begin{equation}\label{eq:range_phase}
	\phi_{scan} = \frac{4 \pi}{\lambda}\left(R\left(\theta_r\right) - R_0\right) .
\end{equation}
Where $R$ is the effective distance between the point target and the phase center.
It is computed using the law of cosines on the green triangle of \autoref{fig:real_aperture_signal_model_geometry} with the included angle $\theta_r$, one  side $L_{ant} = \sqrt{L_{arm}^2 + L_{ph}^2}$ and the other $c = L_{ant} + R_0$.
\begin{equation}\label{eq:range}
	R = \sqrt{ c^2 +  L_{ant}^2 - 2 c L_{ant} \cos{\left(\theta_r - \alpha\right)}}.
\end{equation}
$L_{ant}$ is interpreted as the equivalent lever arm of an antenna without the horizontal phase center shift that would produce the same phase variation as a system with a nonzero $L_{ph}$ and a shorter lever arm.
The function is shifted by the angle  $\alpha = \operatorname{\arctan}\left({\frac{L_{ph}}{L_{arm}}}\right)$ that describes the additional rotation needed for an antenna with nonzero $L_{ph}$ to be at closest approach. This shift is necessary because the azimuth angle is measured assuming a zero $L_{ph}$: the reading given by the angle encoder does not correspond to the angular position of the phase center.\\
The complete characterization of the phase ramp requires the knowledge of the antenna phase center displacement $L_{ph}$. Normally, it is assumed that the phase center is at the midpoint of the antenna. However, when the experimental data was analyzed using this assumption (which implies $L_{ant} = L_{arm}$),  \autoref{eq:range} failed to model the observed azimuth phase variation. The model was thus extended to account for the possibility of a displaced antenna phase center, which is presumed to describe physical differences in the antennas, which would explain the presence of the azimuth phase in the VV channel only.\\ $L_{ph}$ is estimated using the measured phase of a point target by minimizing the squared distance between it an the phase simulated according to \autoref{eq:range}.
\begin{equation}\label{eq:rph_estimation}
	\hat{L_{ph}} = \underset{\left(L_{ph}, \phi_{off}\right)}{\operatorname{argmax}}{\vert\vert\phi_{meas} - \phi_{scan}\vert\vert}^2.
\end{equation}
Where $\phi_{sim} = \phi_{scan} + \phi_{off}$ is the simulated phase with an additional offset that accounts for noise and the intrinsic scattering phase and the system.\\
As seen in \autoref{eq:range}, the distance of each scatterer is a function of the relative rotation angle $\theta_r$ of the antenna. Thus azimuth and distance are coupled, an effect know as Range Cell Migration . In this case, the range resolution is significantly smaller than the amount of RCM and only affects the phase (\autoref{eq:range_phase}).\\
The model has been tested on each reflector in the array: the maximum in range and azimuth was identified and the samples corresponding to the half power beamwidth were extracted at the range of maximum intensity. The unwrapped phase was then used to estimate $r_{ph}$ according to the procedure described in \autoref{eq:rph_estimation}.



\begin{table}[ht]
	\centering
	\pgfplotstabletypesetfile[			col sep=comma,
										columns={name, rsl, LphHH, LphVV},
										every head row/.style={before row=\toprule,after row=\midrule},
										every last row/.style={after row=\bottomrule},
										columns/name/.style={column name={Name} ,string type},
										columns/rsl/.style={precision=1, column name={$R_0 [m]$}},
										columns/LphHH/.style={precision=2, column name={$L_{ph}^{H} [m]$}},
										columns/LphVV/.style={precision=2, column name={$L_{ph}^{V} [m]$}},
										%columns/res/.style={precision=3, column name={residual}},
										]{../tab/table_2.csv}
	\caption{Result of the phase center displacement fit for six trihedral corner reflectors located at different ranges. In the first column, the estimated phase center displacements for the H antenna are shown, in the second the ones for the V unit.}
	\label{tab:rph_fit}
\end{table}
The resulting model parameters fit values  are shown in \autoref{tab:rph_fit} for the H and V antenna; they appear to be consistent and display a standard deviation of less than 2 \% of the antenna length, suggesting that the model is able to predict most of the phase variation. The estimated phase center shift for the H unit is less than 2 cm wile the one for the V antenna is almost one order of magnitude larger. This difference presumably explains the presence of the azimuthal phase ramp in the VV channel only:\\
For a specific target,  $\theta_r$ is limited to the time where it is inside the antenna beamwidth, $\theta_{3dB}$. This small value would not produce any appreciable phase variation. However for increasing values of $L_{ph}$, the entire function of \autoref{eq:range_phase} is rapidly shifted  by a large $\alpha$, simulating the effect of a larger $\theta_r$, as it would be obtained with a much bigger beamwidth.\\
Because crosspolar data is acquired by combining the H and V antennas, the equivalent horizontal phase center location for this case is assumed to lie at the midpoint between $L_{ph}^{H}$ and $L_{ph}^{V}$.\\
When $L_{ph}$ is known, the azimuth phase variation is corrected in each range line $R_{i}$ using \autoref{eq:range} as a matched filter:
\begin{equation}\label{eq:correction}
	\begin{aligned}
		s_{d}^{corr}\left(\theta, R_{i}\right) = &\int\limits_{-\frac{\theta_{int}}{2}}^{\frac{\theta_{int}}{2}}e^{\jmath \frac{4\pi}{\lambda}R\left(\theta - \theta^{\prime}, R_{i}\right)}\\
		&s_{d}\left(\theta^\prime\right) d\theta^\prime,
	\end{aligned}
\end{equation}
The formula replaces the azimuth averaging described in \autoref{sec:proc_SLC}: the samples are now averaged with the appropriate phase factor so that the SNR improvement and the correction of the azimuth trend are combined in a single step. Usually, after convolution only the central pixel of the integration window is kept, to reduce the amount of data, as the original acquisition is always oversampled in azimuth. Because the model only describes the variation of the phase relative to closest approach $R_{0}$, the absolute phase is preserved; this is very important for interferometric applications.\\
The procedure is similar to azimuth focusing of synthetic aperture data, where the cross-range resolution is obtained by the integration of the data in the azimuth-time direction. However, in the case of real aperture systems the resolution is limited by physical antenna beamwidth and the response of a target  occupies a single azimuth sample; unless the data is oversampled. In the first case, integrating the data in azimuth degrades the resolution because samples that do represent the same scatterer are combined.\\ To correct the phase variation without an excessive increase in azimuth resolution, the integration is limited to a window of size $\theta_{int}$. The optimal trade-off is empirically determined to be $0.6^\circ$, slightly larger than $\theta_{3dB}$.\\
The result of applying the correction to the TCR "Hindere Chlapf" at 673 m is displayed in panels (c) and (f) of \autoref{fig:tcr_mph}; the phase ramp is significantly reduced while the azimuth resolution is slightly degraded. However, the observed azimuth resolution is still smaller than $0.6^\circ$, the value that would be observed if the samples were to be summed incoherently, without accounting for the phase ramp. This result hints again that  most of the phase ramp has been removed by the proposed method.\\
Similar results are observed for all reflector, as displayed in \autoref{fig:phase_response_VV:corrected} where the phase and amplitude response in both the HH and VV channel is plotted. Generally, the HH data shows a much smaller variation, while the VV phase displays an almost linear increase of 30$^\circ$. As expected from the estimated phase center location in \autoref{tab:rph_fit}, the phase slopes for the two antennas have opposite signs.\\  After the correction, only the reflector "Chutzen" shows a large residual azimuth phase variation; this behavior is attributed to its closeness to the radar relative to the far field transition distance of the antennas, in the order of 500 m. Excluding this exception, the residual variation is under $10^\circ$ for samples inside the antenna beamwidth, while the azimuth resolution is slightly increased due to the azimuth integration.
\begin{figure*}[ht]
	\centering
	\begin{subfigure}[t]{\textwidth}
		\centering
		\includegraphics{figure_2}
		\subcaption{Response without azimuth filtering.}
		\label{fig:phase_response_VV:uncorrected}
	\end{subfigure}\\
	\begin{subfigure}[t]{\textwidth}
		\centering
		\includegraphics{figure_3}
		\subcaption{Response after azimuth filtering.}
		\label{fig:phase_response_VV:corrected}
	\end{subfigure}
	\caption{Relative phase/amplitude response for all reflectors in the calibration array, continous line: VV channel, dashed: HH channel. To display the relative phase variation, the phase at the maximum is subtracted from each plot. The vertical lines indicate the theoretical 3 dB resolution of the antenna $\theta_{3dB}$. The responses for the HH channel are not plotted because no significant phase trend is observed.}
	\label{fig:phase_response_VV}
\end{figure*}

\subsection{Antenna Pattern Misalingment}
\begin{figure*}[ht!]
	\centering
	\includegraphics{figure_4}
	\caption{Azimuth power response of a dihedral corner reflector, before and after the correction of antenna pattern mispointing. The observed gain is in line with the expected power loss due to the H and V patterns not perfectly overlapping.}
	\label{fig:hv_power}
\end{figure*}
To verify the impact of the H-V pattern pointing shift as described in \autoref{sec:misalingment} on the performance of crosspolar measurements, the response of a dihedral reflector with an high crosspolar contribution is analyzed for two configurations:\\ \begin{enumerate*}\item the case where the antennas are not mechanically moved \item the case where the optimal shift of 1.8 mm, as described in \autoref{sec:misalingment} is applied to the movable antenna hinge to bring the patterns into alignment.\\ 
\end{enumerate*}
In \autoref{fig:hv_power}, the result of the above experiment is shown as the oversampled, coregistered azimuth response in the HV channel; a gain of approx. 2.5 dB is observed after correcting for the pattern misalignment. The estimated gain is very close to the one expected by analyzing the provided antenna patterns. This results confirms that the 1.8 mm shift setting employed to acquire the calibration data can correctly compensate the crosspolar power loss and the HH-VV misregistration.

\subsection{Removal of Topographic Phase}\label{sec:topo_removal}
The removal of the topographic phase contribution in the copolar phase difference, as described in \autoref{sec:topo_removal}, is visualized in  \autoref{fig:topo_phase}. When the topographic contribution is not compensated for, fringes are clearly visible (\autoref{fig:topo_phase:uncorrected}). An estimate of this contribution is obtained by the unwrapped and rescaled interferogram between the upper and the lower HH channels, which due to their being separated by a spatial baseline (as seen in \autoref{fig:antenna_arrangement}) provides an estimate of the topographic phase without additional polarimetric phase differences. The contribution thus obtained is then subtracted from the covariance matrix; the resulting flattened covariance matrix is virtually free of topographic contributions up to unwrapping errors and can be employed for polarimetric calibration.
\begin{figure*}[hb]
	\centering
	\begin{subfigure}[t]{\textwidth}
	\centering
	\includegraphics{figure_9}
	\subcaption{With topographic phase.}
	\label{fig:topo_phase:uncorrected}
	\end{subfigure}\\
	\begin{subfigure}[t]{\textwidth}
	\centering
	\includegraphics{figure_10}
	\subcaption{Without topographic phase.}
	\label{fig:topo_phase:corrected}
	\end{subfigure}
	\caption{HHVV phase difference in radar coordinates, before and after the removal of the topographic phase term as described in \autoref{sec:topo_removal}. The hue of the image is modulated by the covariance phase, the intensity by the magnitude. A fringe pattern is clearly visible in (a), which is completely removed after applying the proposed correction, as plotted in (b).}
	\label{fig:topo_phase}
\end{figure*}
\subsection{Polarimetric Calibration}\label{sec:res_polcal}

								
\begin{table}[h]
	\centering
	\pgfplotstabletypesetfile[
		col sep=comma,
		columns={name, slant range, HH-VV amplitude imbalance, HH-VV phase imbalance, Polarisation purity},
		every head row/.style={before row=\toprule,after row=\midrule},
		every last row/.style={after row=\bottomrule},
		columns/name/.style={column name={Name} ,string type},
		columns/slant range/.style={precision=1, column name=\makecell{$R_{0} [m]$\\ Range distance}},
		columns/HH-VV amplitude imbalance/.style={precision=3, column name={$f$}},
		columns/HH-VV phase imbalance/.style={precision=3, column name={$\phi_r + \phi_t [^\circ]$}},
		columns/Polarisation purity/.style={precision=3, column name={Purity $[dB]$}}
	]{../tab/table_3.csv}
	\caption{Copolar phase ($\phi_r + \phi_t$) and amplitude imbalance ($f$) computed on the reflectors using the calibrated dataset. The polarization purity (VV/HV ratio) is shown additionally. Results for the reflector used to determine calibration parameters are not shown.}
	\label{tab:polcal}
\end{table}		
The methods described in the preceding sections were applied to prepare SLC images for each channel. For the final polarimetric calibration the procedure of \autoref{sec:proc_polcal} was used; one reflector in the scene was used as a calibration target, with the four remaining reflectors used for the determination of the calibration performance.\\
An initial assessment of the data quality is made  by computing polarization signatures\cite{VanZyl1987} for two of the five corner reflectors that were not used to determine the calibration parameters. They are plotted in \autoref{fig:signatures}.
\begin{figure*}[hb]
	\centering
	\begin{subfigure}[t]{\textwidth}
	\centering
	\includegraphics{figure_5}
	\subcaption{Reflector at 673 m.}
	\label{fig:signatures:near}
	\end{subfigure}\\
	\begin{subfigure}[t]{\textwidth}
	\centering
	\includegraphics{figure_6}
	\subcaption{Reflector at 2690 m.}
	\label{fig:signatures:far}
	\end{subfigure}
	\caption{Polarisation signatures for two trihedral corner reflectors located at different distances from the radar. Left column: copolar signature, right crosspolar signature; top row: uncalibrated, bottom row: calibrated. The power is shown normalized to the peak of the response.}
	\label{fig:signatures}
\end{figure*}

The signature for the uncorrected data does not correspond to the signatures of any basic scattering mechanism. In the calibrated response, both reflectors show a correspondence with the expected polarization signature for trihedral reflectors.\\
\begin{figure*}[ht!]
	\centering
	\includegraphics{figure_8}
	\caption{Dependence of the residual copolar phase and amplitude imbalances on the local incidence angle. The mean and RMS imbalances are shown in each plot. The reflector used for the determination of calibration parameters has been excluded from the plot.}
	\label{fig:inc_angle_trend}
\end{figure*}
A quantitative evaluation of the calibration is obtained by estimating the residual copolar phase and amplitude imbalances $f$ and $\phi_r + \phi_t$ on the trihedral from calibrated data, excluding the reflector used to determine the parameter. The results are shown in \autoref{tab:polcal}. Generally, both the amplitude and the phase imbalance appear to be well corrected. The mean residual for $f$ is 0.97 with an RMS of 0.05. Similarly, for the residual phase difference a mean of $4^\circ$ is observed, with a RMS of $7^\circ$. The biggest outlier for $f$ is represented by reflector "Chutzen", placed very close to the radar, at 73 m slant range. As previously discussed, it is not located sufficiently far away to be in the far field region of the antennas; this could explain the discrepancy from the rest of the array.
In \autoref{fig:inc_angle_trend}, the dependence of the residuals on the local incidence angle is plotted; no clear trend can be distinguished, however it is rather difficult to judge this observation given the small number of data points available and the rather limited extent of covered incidence angles. However, given the small RMS and mean residual errors, the choice of a model that does not consider variation of calibration parameters with incidence angle appears to be justified. The absence of clear incidence-angle related trends is also seen as hinting the appropriateness of the method proposed in \autoref{sec:proc_polcal} to remove the topographic contribution from the polarimetric phase differences: larger variation would otherwise be observed.\\
The assumption of negligible crosstalk seems plausible considering that all reflectors  except the very far one show a polarization purity above 35 dB. In the former case, the combination of large azimuth resolution cell size, the relatively low RCS of the TCR and  the difficulty of exactly pointing it towards the radar may have lowered the purity because of a larger influence of clutter in the cell.



