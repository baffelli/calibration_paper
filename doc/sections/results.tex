\section{Results}\label{sec:results}
\subsection{FMCW Data Processing}\label{sec:res_SLC}
In order to assess the processing quality and to appreciate the effect of the beam squint correction, in  \autoref{fig:tcr_mph} the oversampled impulse response of the 90 cm TCR at 659 m slant range is plotted. The plots on the left side (\autoref{fig:tcr_mph:HH_uncorr}, \autoref{fig:tcr_mph:VV_uncorr}) contain the response obtained by directly range compressing the dechirped data. The phase displays interesting patterns, with the equiphase contours forming a cross shape centered at the center of the reflector. The shift between the HH and the VV channel is visible too, as the response for the one channel is shifted with respect to the other plot.\\ A visual comparison with the same response obtained enabling the squint compensation, shows an improvement in both the range and the azimuth resolutions; this is confirmed numerically by fitting a spline on the azimuth and range responses and computing its 3 dB width. The numerical results are shown above each plot of \autoref{fig:tcr_mph}; signficant improvements in both range and azimuth are clear, especially so for the HH channel, that shows a range resolution improvement of 0.24 m. This gain is reduced to only 0.17 m for the VV channel.\\ Similarly, a reduction in the phase variation is visible especially for the HH channel, (\autoref{fig:tcr_mph:HH_corr}) while the phase response of VV channel shows a residual phase ramp in azimuth direction (\autoref{fig:tcr_mph:HH_corr}).
\def\chutzepref{20160914_145059}
\begin{figure*}[ht]
	\begin{subfigure}[b]{0.6\columnwidth}
		\centering
		\includegraphics[scale=0.7]{\chutzepref_1331_1490_AAAl_chan_mph_plot}
		\subcaption{HH channel without beam squint correction.}
		\label{fig:tcr_mph:HH_uncorr}
	\end{subfigure}~
	\begin{subfigure}[b]{0.6\columnwidth}
		\centering
		\includegraphics[scale=0.7]{\chutzepref_1331_1490_AAAl_desq_mph_plot}
		\subcaption{HH channel with squint correction.}
		\label{fig:tcr_mph:HH_corr}
	\end{subfigure}~
	\begin{subfigure}[b]{0.6\columnwidth}
		\centering
		\includegraphics[scale=0.7]{\chutzepref_1331_1490_AAAl_corr_mph_plot}
		\subcaption{HH channel with squint and azimuth ramp correction.}
		\label{fig:tcr_mph:HH_corr_ph}
	\end{subfigure}\\
	\begin{subfigure}[b]{0.6\columnwidth}
		\centering
		\includegraphics[scale=0.7]{\chutzepref_1331_1490_BBBl_chan_mph_plot}
		\subcaption{VV channel without beam squint correction.}
		\label{fig:tcr_mph:VV_uncorr}
	\end{subfigure}~
	\begin{subfigure}[b]{0.6\columnwidth}
		\centering
		\includegraphics[scale=0.7]{\chutzepref_1331_1490_BBBl_desq_mph_plot}
		\subcaption{VV channel with squint correction.}
		\label{fig:tcr_mph:VV_corr}
	\end{subfigure}~
	\begin{subfigure}[b]{0.6\columnwidth}
		\centering
		\includegraphics[scale=0.7]{\chutzepref_1331_1490_BBBl_corr_mph_plot}
		\subcaption{VV channel with squint and azimuth ramp correction.}
		\label{fig:tcr_mph:VV_corr_ph}
	\end{subfigure}~

	\caption{Oversampled phase and amplitude response for the trihedral corner reflector.}
	\label{fig:tcr_mph}
\end{figure*}
\subsection{Antenna Pattern Misalingment}
\begin{figure}[ht!]
	\centering
	\includegraphics{../outputs/img/HV_gain}
	\caption{Before H-V shift correction}
	\label{fig:hv_power:uncalibrated}
	\caption{Azimuth response for a point-like target with high crosspolarized contribution.}
	\label{fig:hv_power}
\end{figure}
To verify the impact of the $H$-$V$ pattern pointing shift on the performance of crosspolar measurement, the response of a dihedral reflector with an high crosspolar contribution is analyzed for two configurations:\\ \begin{enumerate*}\item the case where the antennas are not mechanically moved \item the case where the optimal shift of 1.8 mm is applied to bring the patterns into alignment.\\ Because of logistical problems, this experiment was carried out at the H\"{o}nggerberg campus separately from the rest of the measurements shown in this section.
\end{enumerate*}
In \autoref{fig:hv_power}, the result of the above experiment is shown as the oversampled, coregistered azimuth response in the $HV$ channel; a gain of approx. 2.5 dB is observed after correcting for the pattern misalignment. The estimated gain is very close to the one expected by analyzing the provided antenna patterns. This results confirms that the 1.8 mm shift setting employed to acquire the calibration data can correctly compensate the crosspolar power lost and the $HH-VV$ misregistration. However,  
\subsection{Azimuth Processing}
This residual phase described in \autoref{sec:res_SLC}  is problematic in two manners: \begin{enumerate*}
	\item because of the coherent average of pixels affected by the phase ramp\label{item:SNR}  $\sigma$ after azimuth averaging (see \autoref{sec:proc_SLC}) will appear smaller than it actually is.
  \item because of the different phase behavior of the antennas, the coherence magnitude of polarimetric phase differences will be reduced; the resulting coherence phase will be affected by a residual phase variation. For example, if the HH-VV phase is needed for calibration in the method described in \autoref{sec:proc_polcal} and the azimuth variation is not taken into account, the additional phase will lead to incorrect calibration parameters.\label{item:phase_variation}\end{enumerate*}
The ramp are caused by the antennas being mounted offset from the rotation center of the  radar~\cite{Lee2014}, so that during the scan the distance from the antenna phase center to a fixed point in the scene changes as a function of the antenna azimuth position. From a geometrical perspective it can be interpreted as a radar moving along a circular trajectory of radius $L_{arm}$. In SAR system the phase variation is exploited to synthesize a large aperture by increasing the antenna beamwidth and the length of the trajectory, so that the illumination time of the point is maximized. In contrast to that case, the illumination time here is to short to allow synthesizing an aperture larger than the antennas physical beamwidth and the only effect of the circular trajectory is the azimuth phase modulation.\\
To quantify the phase modulation, consider the antenna configuration in \autoref{fig:real_aperture_signal_model_geometry}:
The antennas are mounted on a lever arm of length $L_{arm} = 0.25$ m that connects them to the azimuth scanner. The phase center of the antenna is horizontally displaced from the lever arm attachment by $L_{ph}$, this parameter was added empirically to obtain better phase fits; it models antenna manufacturing imprecisions. A point target is considered, located at the slant range  of closest approach $R_{0}$, obtained when the phase center, the target and the lever arm all lie on a line. The antenna is now rotated by an angle $\theta_r$ relative to the situation of closest approach. The distance $R$ from the target will change during this movement and a corresponding variation of the phase will observed, according to:
\begin{equation}\label{eq:range_phase}
	\phi_{scan} = \frac{4 \pi}{\lambda}R\left(\theta_r\right).
\end{equation}
To compute $R$, the law of cosines is applied to the triangle of~\autoref{fig:real_aperture_signal_model_geometry}, with the included angle $\theta_r$, one side length $L_{ant} = \sqrt{L_{arm}^2 + L_{ph}^2}$ and the other side $c = L_{ant} + R_0$.  $L_{ant}$ is the equivalent antenna rotation arm for a system with no phase center shift.
$R$, the range from the target to the antenna as a function of the rotation from the closest approach $\theta_r$ is:
\begin{equation}\label{eq:range}
	R = \sqrt{ c^2 +  L_{ant}^2 - 2 c L_{ant} \cos{\left(\theta_r - \alpha\right)}}.
\end{equation}
The function is shifted by the angle  $\alpha = \operatorname{\arctan}\left({\frac{L_{ph}}{L_{arm}}}\right)$ that describes the additional rotation needed for an antenna with nonzero $L_{ph}$ to be at closest approach with the target compared to the regular case. This shift is necessary because antenna rotation is measured assuming a zero $L_{ph}$; the azimuth position read at the encored of the antenna scanner does not correspond to the azimuth of the phase center.\\
As seen in \autoref{eq:range}, the distance of each scatterer is a function of the relative rotation angle $\theta_r$ of the antenna. Thus azimuth and distance are coupled, this effect is known as Range Cell Migration RCM. In this case, the range resolution is small enough compared to the RCM that only the effect of the rotation on the phase (\autoref{eq:range_phase}) will be considered.\\
The complete characterization of the azimuth phase requires the knowledge of the antenna phase center displacement $L_{ph}$. This value is generally not known a priori as it is assumed that the phase center is located at the midpoint of the array. However, when the experimental data was analyzed assuming this case to be true (which implies $L_{ant} = L_{arm}$),  \autoref{eq:range} failed to model the observed azimuth phase variation for the response of a trihedral corner reflector. The model was thus modified to account for the possibility of a displaced antenna phase center. The parameter $L_{ph}$ can be determined from the measured data of a point target. SLC images are generated according to the procedure described in \autoref{sec:proc_SLC}. The azimuth phase profile for the point target is then extracted and used in a nonlinear optimization problem with the phase simulated according to \autoref{eq:range}:
\begin{equation}\label{eq:rph_estimation}
	\hat{r_{ph}} = \underset{\left(L_{ph}, \phi_{off}\right)}{\operatorname{argmax}}{\vert\vert\phi_{meas} - \phi_{sim}\vert\vert}^2.
\end{equation}
Where $\phi_{sim} = \phi_{scan} + \phi_{off}$ is the simulated phase with an additional offset that accounts for the phase induced by the noise, the intrinsic scattering phase and the system.
The model is tested by applying the fit procedure of \autoref{eq:rph_estimation} to the calibration array. For each reflector, the maximum in range and azimuth was identified and the samples corresponding to the half power beamwidth were extracted at the range of maximum intensity. The unwrapped phase was then used to estimate $r_{ph}$ according to the procedure described in \autoref{eq:rph_estimation}.
\begin{table}[ht]
	\centering
	\begin{tabular}{lccl}
		\hline
		reflector & $R_0$ & $\hat{L_{ph}}$ & comments\\
		1	& 74 m & -0.17 & \\
		2  & 672 m & -0.10 & \\
		3 & 824 m & -0.11 & \\
		4 & 838 m & -0.14 &\\
		5 & 1048 m & -0.11&\\
		6 & 2690 m & -0.11&\\
		\hline
	\end{tabular}
	\caption{Result of the phase center displacement fit for six trihedral corner reflectors located at different ranges.}
	\label{tab:rph_fit}
\end{table}
The resulting fit values (\autoref{tab:rph_fit}) have a standard deviation of less than 2 \% of the antenna length, suggesting that the model is able to predict  most of the phase variation.\\
When $L_{ph}$ has been estimated, the azimuth phase variation is corrected using \autoref{eq:range} as a range-variant matched filter. Each azimuth line in the range compressed, squint corrected data $s_{d}$ is convolved with:
\begin{equation}\label{eq:correction}
	\begin{aligned}
		s_{d}^{corr}\left(\theta, R_{0}\right) = &\int\limits_{-\frac{L_{int}}{2}}^{\frac{L_{int}}{2}}e^{\jmath \frac{4\pi}{\lambda}\left(R\left(\theta - \theta^{\prime}, R_{0}\right) - R_{0}\right)}\\
		&s_{d}\left(\theta^\prime\right)w(\theta - \theta^{\prime}) d\theta^\prime,
	\end{aligned}
\end{equation}
where $w$ is a windowing function. The formula replaces the incoherent azimuth averaging described in \autoref{sec:proc_SLC} the samples are now averaged with the appropriate phase factor so that the SNR improvement and the correction of the azimuth trend are combined in a single step. In computing the filter, the range of closest approach $R_{0}$ is subtracted from the current range $R$ to correct the relative phase variation only; this is important for interferometric processing where the absolute phase has to be preserved.\\
The procedure is similar to the azimuth focusing of synthetic aperture data, where the cross-range resolution is obtained by the integration of the data in the azimuth-time direction. However, in the case of real aperture systems the resolution is limited by  physical antenna beamwidth and the response of a target ideally occupies a single azimuth sample. Integrating the data in azimuth degrades the resolution because samples that do not contain information on the same scatterer are combined together. To correct the phase variation without an excessive deterioration in azimuth resolution, the integration is limited to a window  $w$ of length $L_{int}$. The optimal trade-off was empirically determined to be $0.6^\circ$, slightly larger than $\theta_{3dB}$.\\
The result of applying the correction to the TCR at 658 m is displayed in the rightmost column of \autoref{fig:tcr_mph}; the phase ramp is significantly reduced while the azimuth resolution is slightly degraded.
The phase and amplitude responses for all reflectors are plotted for the VV channel in \autoref{fig:phase_response_VV}. A linear variation of 30 degrees over the 3dB antenna beamwidth can be observed. The reflectors at 74 m shows a quadratic azimuth phase variation; it was likely too close to the radar, so that it was not illuminated with the complete antenna pattern as the far field transition distance of the slotted array is expected to be of the order of 500 m. This situation could explain its distorted amplitude response as well. 
\begin{figure}[ht]
	\begin{subfigure}[t]{\columnwidth}
		\includegraphics{\chutzepref_BBBl_coreg_phase_plot}
		\subcaption{Azimuth phase ramp not corrected.}
	\end{subfigure}
	\begin{subfigure}[t]{\columnwidth}
		\includegraphics{\chutzepref_BBBl_corr_phase_plot}
		\subcaption{After azimuth filter.}
	\end{subfigure}
	\caption{Relative phase/amplitude response for all reflectors in the calibration array, VV channel. The phase at the azimuth position where the highest intensity is measured has been subtracted in order to show the relative phase variation only. The dotted lines display the theoretical 3 dB resolution of the antennas $\theta_{3dB}$}
	\label{fig:phase_response_VV}
\end{figure}
\subsection{Polarimetric Calibration}\label{sec:res_polcal}
\begin{figure*}[ht]
	\begin{subfigure}[t]{2\columnwidth}
		\includegraphics[scale=2]{\chutzepref_l_cal_gc_pauli}
		\subcaption{Calibrated Pauli RGB Composite.}
		\label{fig:gc:pauli_rgb}
	\end{subfigure}
	\begin{subfigure}[t]{\columnwidth}
		\includegraphics{\chutzepref_l_cal_gc_alpha}
		\subcaption{Calibrated mean Cloude-Pottier $\alpha$ parameter.}
		\label{fig:gc:alpha}
	\end{subfigure}
	\begin{subfigure}[t]{\columnwidth}
		\includegraphics{\chutzepref_l_cal_gc_H}
		\subcaption{Calibrated  Cloude-Pottier $H$ parameter.}
		\label{fig:gc:H}
	\end{subfigure}
	\caption{Calibrated Pauli RGB, entropy and $\alpha$ parameters, geocoded with 1m pixel spacing.}
	\label{fig:gc}
\end{figure*}
The methods described in the preceding sections were applied to prepare SLC images for each channel. For the final polarimetric calibration the procedure of \autoref{sec:proc_polcal} was used; one reflector in the scene was used as a calibration target, with the four remaining reflectors used for the determination of the calibration performance.\\
An initial assessment of the data quality is made by plotting polarization signatures\cite{VanZyl1987} for the  five corner reflectors that were not used to determine the calibration parameters. \autoref{fig:pol_signatures} shows the results for five reflectors both before and after the proposed method.
The signature in the uncorrected data is complex and cannot be easily interpreted as representing any known basic scattering mechanism. In the calibrated response, all reflectors show a good correspondence with the expected polarization signature of a trihedral reflector.\\
As a quantitative assessment of the calibration,  $f$ and $\phi_r + \phi_t$ are re-estimated on the calibrated data for the five reflectors that are not used to estimate the calibration. The results are shown in \autoref{fig:pol_signatures} in the caption under each signature. Generally, both the amplitude and the phase imbalance appear to be well corrected, with a RMS $f$ of 1.0 and $14^\circ$ for $\phi_r + \phi_t$. However, the result is heavily biased by the near and far range reflectors in \autoref{fig:pol_signatures:refl1} and \autoref{fig:pol_signatures:refl5} , where a larger residual phase and amplitude imbalance is still visible. In the case of the reflector at 74 m, the less than ideal response is presumably explained by it being placed too close to the radar compared to the expected far field distance of the antennas, that is in the order of 600 m. For the far reflector, the most likely reason for the poor performance is its placement  close to vegetation and field enclosures and the difficulty of precisely pointing it in elevation and azimuth at large distances from the radar. This is corroborated by the smaller observed RCS compared to the other reflectors and by the noisy amplitude and phase responses in \autoref{fig:phase_response_VV}.\\
Finally, to visualize the result of the calibration, RGB Pauli composites of the scene are shown in \autoref{fig:gc:pauli}. Because very little information can be extracted from this image, a more quantitative understanding of the scene is gained by applying the Cloude-Pottier decomposition on the calibrated data. The data is first converted in cartesian coordinates with 1 meter pixel spacing; it is then multi-looked with a window size of $5 \times 2$ pixels, finally the decomposition parameters are computed from the thus obtained covariance matrix. The $\alpha$ and $H$ parameters are plotted in \autoref{fig:gc:alpha} and \autoref{fig:gc:H} . The response of most natural surfaces appears to be a low entropy, low $\alpha$ scattering usually associated with Bragg/X-Bragg surface scattering. The dominance of surface scattering is attributed to a combination of object roughness  at the scale of the radar wavelength (1.7 cm) and the small penetration depth. A few pixels in the far range area corresponding to the town of M\"{u}nsingen display low entropy dihedral scattering behavior, these points can be likely associated with double bounce interaction between buildings and ground.\\



\def\refI{../outputs/img/\chutzepref_32_519}
\def\refII{../outputs/img/\chutzepref_1032_570}
\def\refIII{../outputs/img/\chutzepref_1051_561}
\def\refIV{../outputs/img/\chutzepref_1331_149}
\def\refV{../outputs/img/\chutzepref_3518_354}

\pgfplotstableread[col sep=comma]{\refI_l_cal_cal_params.csv}{\refIt}
\pgfplotstableread[col sep=comma]{\refII_l_cal_cal_params.csv}{\refIIt}
\pgfplotstableread[col sep=comma]{\refIII_l_cal_cal_params.csv}{\refIIIt}
\pgfplotstableread[col sep=comma]{\refIV_l_cal_cal_params.csv}{\refIVt}
\pgfplotstableread[col sep=comma]{\refV_l_cal_cal_params.csv}{\refVt}
\pgfplotstableset{ref style/.style={
									display columns/0/.style={precision=2, column name=$\phi_r + \phi_t [\circ]$},
									display columns/1/.style={precision=2, column name=$f$},
									display columns/2/.style={precision=1, column name=$\frac{HH}{HV} [dB]$},
									display columns/4/.style={precision=1, column name=$R_{0}$},
									display columns/3/.style={precision=1, column name=$\beta_{0}$}
				}}

\newcommand\signatures[1]{
						\begin{tikzpicture}[]
							\node(copoluncal) at (0,0){\includegraphics{#1_flat_signature}};
							\node[right  =  0.1cm  of copoluncal] (xpoluncal) {\includegraphics{#1_flat_signature_x}};
							\node[below = 0.5 cm of copoluncal] (copolcal) at (0,0){\includegraphics{#1_cal_signature}};
							\node[right  = 0.1cm of copolcal] (xpolcal) {\includegraphics{#1_cal_signature_x}};
							\node[left = 0.1 cm of copoluncal.west, rotate = 90, above = 0.25cm of copoluncal.west ] (uncaltitle) {Uncalibrated};
							\node[left = 0.1 cm of copolcal.west, rotate = 90, above = 0.25cm of copolcal.west] (caltitle) {Calibrated};
						\end{tikzpicture}
					}


\begin{figure*}[hb]
		\begin{subfigure}[t]{\columnwidth}
		\centering
			\signatures{\refI_l}

			\subcaption{Reflector 1\\ 
					\pgfplotstabletypeset[ref style] {\refIt}
					}
			\label{fig:pol_signatures:refl1}
		\end{subfigure}
		\begin{subfigure}[t]{\columnwidth}
			\centering
			\signatures{\refII_l}
			\subcaption{Reflector 2 \\  
						\pgfplotstabletypeset[ref style] {\refIIt}
						}
			\label{fig:pol_signatures:refl2}
		\end{subfigure}
		\begin{subfigure}[t]{\columnwidth}
			\centering
			\signatures{\refIII_l}
			\subcaption{Reflector 3\\ 						
									\pgfplotstabletypeset[ref style] {\refIIIt}
						}
			\label{fig:pol_signatures:refl3}
		\end{subfigure}
		\begin{subfigure}[t]{\columnwidth}
			\centering
			\signatures{\refIV_l}
			\subcaption{Reflector 4\\ 
									\pgfplotstabletypeset[ref style] {\refIVt}
			           }
			\label{fig:pol_signatures:refl4}
		\end{subfigure}\\
\end{figure*}	
\begin{figure*}[H]		
		 \ContinuedFloat
		\begin{subfigure}[t]{\columnwidth}
			\centering
			\signatures{\refV_l}
			\subcaption{Reflector 5\\ 
									\pgfplotstabletypeset[ref style] {\refVt}
        }
			\label{fig:pol_signatures:refl5}
		\end{subfigure}
		\caption{Polarization signatures for the calibration array, acquired using the lower receiver. The top row for each subplot shows the response before the calibration procedure, the bottom one the calibrated response. Each caption contains the calibration parameters re-estimated after the calibration. The imbalances are in degrees, the slant range distance in meters.}
		\label{fig:pol_signatures}
\end{figure*}